<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Risultati Ricerca</title>
    <link rel="stylesheet" href="/css/index.css">
</head>
<body>
<div class="hero">
    <header class="header">
        <figure>
            <img src="/images/tune-removebg-preview%20(1)%201.png" alt="Logo TuneHub">
        </figure>
        <nav>
            <form action="/research" method="post">
                <input name="searchQuery" placeholder="Cerca una canzone" required type="text">
                <button type="submit">Cerca</button>
            </form>
        </nav>
    </header>

    <main>
        <h3>Risultati della ricerca</h3>
        <div class="orange-border"></div>

        <div th:if="${error != null}" class="error">
            <p th:text="${error}"></p>
        </div>

        <div th:if="${tracks != null and !tracks.empty}">
            <h4>Canzoni trovate:</h4>
            <ul class="track-list">
                <li th:each="track : ${tracks}">
                    <div class="track-info">
                        <a th:href="${track.external_urls.spotify}" target="_blank">
                            <span th:text="${track.name}"></span> -
                            <span th:each="artist,iter : ${track.artists}">
                                <span th:text="${artist.name}"></span>
                                <span th:unless="${iter.last}">, </span>
                            </span>
                        </a>
                        <audio th:if="${track.preview_url}" th:src="${track.preview_url}" controls></audio>

                        <form action="/addSongToPlaylist" method="post">
                            <input type="hidden" name="trackName" th:value="${track.name}">
                            <input type="hidden" name="trackArtist" th:value="${track.artists[0].name}">
                            <select name="nomePlaylist" required>
                                <option value="">Seleziona playlist</option>
                                <option th:each="playlist : ${playlists}"
                                        th:value="${playlist}"
                                        th:text="${playlist}"></option>
                            </select>
                            <button type="submit">Aggiungi</button>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </main>
</div>
</body>
</html>